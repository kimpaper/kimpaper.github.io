---
layout: post
title: 하둡 스프링 연동 테스트 - hadoop 2.6.x with spring 4.0
date: '2015-04-12T19:46:00.002-07:00'
author: 페이퍼
tags:
- hadoop
- spring
modified_time: '2015-10-05T20:37:14.650-07:00'
blogger_id: tag:blogger.com,1999:blog-335715462918866001.post-7603073138487848030
blogger_orig_url: http://kimpaper.blogspot.com/2015/04/hadoop-26x-with-spring-40.html
---

  Hadoop 설치 및 설정은 아래와 같이 (osx 요세미티.) <br />https://hadoop.apache.org/releases.html#Download ( 2.6.x 버전 ) <br /><br />설치는 아래 블로그 보고 함 <br />http://iamhereweare.blogspot.kr/2014/05/hadoop.html<br /><br /><br />- pom.xml 에 아래 dependency 추가. <br /><pre><code><br /><dependency><br />  <groupid>org.springframework.data</groupId><br />  <artifactid>spring-data-hadoop</artifactId><br />  <version>2.1.1.RELEASE</version><br /></dependency><br /></code></pre><br /><br />- context-hadoop.xml spring 설정에 파일 추가 <br /><pre><code><br /><?xml version="1.0" encoding="UTF-8"?><br /><beans xmlns="http://www.springframework.org/schema/beans"<br />      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"<br />      xmlns:hdp="http://www.springframework.org/schema/hadoop"<br />      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd<br />        http://www.springframework.org/schema/hadoop http://www.springframework.org/schema/hadoop/spring-hadoop.xsd"><br /><br />    <hdp:configuration id="hdConf"><br />        fs.default.name=hdfs://localhost:9000<br />    </hdp:configuration><br /><br /></beans><br /></code></pre><br /><br />아래와 같이 test코드 작성. <br />- HdTestServiceTest.java <br /><pre><code><br />@RunWith(SpringJUnit4ClassRunner.class)<br />@ContextConfiguration({<br />        "classpath:servlet-context.xml",<br />        "classpath:config/context-datasource.xml",<br />        "classpath:config/context-hadoop.xml"<br />})<br />public class HdTestServiceTest {<br />    private static final Logger logger = LoggerFactory.getLogger(HdTestService.class);<br /><br />    @Autowired<br />    private org.apache.hadoop.conf.Configuration hdConf;<br /><br />    @Test<br />    public void testDoTest() throws Exception {<br />        FileSystem hdfs = null;<br />        try {<br />            Path filePath = new Path("/tmp/test.txt");<br />            logger.info("filePath.uri={}", filePath.toUri());<br /><br />            hdfs = FileSystem.get(filePath.toUri(), hdConf);<br /><br />            if(hdfs.exists(filePath)) {<br />                logger.info("read file path={}", filePath);<br />                BufferedReader r = new BufferedReader(new InputStreamReader(hdfs.open(filePath), "utf-8"));<br />                String line = null;<br />                do {<br />                    line = r.readLine();<br />                    logger.info("  line={}", line);<br />                }<br />                while(line != null);<br />                r.close();<br /><br />                // dfs.delete(filePath, true);<br />            } else {<br />                logger.info("create new file path={}", filePath);<br /><br />                FSDataOutputStream out = hdfs.create(filePath, false);<br />                out.write("한글 생성 테스트".getBytes("utf-8"));<br />                out.flush();<br />                out.close();<br />            }<br />        }<br />        finally {<br />            IOUtils.closeQuietly(hdfs);<br />        }<br />    }<br />}<br /></code></pre><br />잘된다. 다만 아직 로컬에서 못벗어 났지만.. 벗어날 서버가 없어..<br />위 코드를 이용하면 파일 업로드 다운로드까지는 구현이 가능하겠다.    