---
layout: post
title: spring jpa 설정 및 테스트 (maven 설정)
date: '2015-10-05T00:41:00.001-07:00'
author: 페이퍼
tags:
- spring
modified_time: '2015-10-12T02:44:48.380-07:00'
blogger_id: tag:blogger.com,1999:blog-335715462918866001.post-7944949787333282
blogger_orig_url: http://kimpaper.blogspot.com/2015/10/spring-jpa-maven.html
---

거의 대부분 mybatis 를 이용하여 개발을 하는데..<br />JPA가 대세라고 해서 가벼운 프로젝트에 연동을 해봤습니다.<br /><br />1. 라이브러리 import....<br />maven pom.xml<br /><pre><code><br /><dependency><br />   <groupid>org.springframework.data</groupid><br />   <artifactid>spring-data-jpa</artifactid><br />   <version>1.9.0.RELEASE</version><br /></dependency><br /><dependency><br />   <groupid>org.hibernate</groupid><br />   <artifactid>hibernate-entitymanager</artifactid><br />   <version>4.3.8.Final</version><br /></dependency><br /></code></pre><br /><br />2. Entity class를 만들어 줍니다.<br />참고로 SerializedName, Expose는  jpa와 직접 관련은 없습니다.. (개체를 그대로 JsonView 할때 사용)<br /><pre><code><br />import com.google.gson.annotations.Expose;<br />import com.google.gson.annotations.SerializedName;<br /><br />import javax.persistence.*;<br /><br />@Entity<br />@Table(name="tb_notice")<br />public class Notice {<br />    @Id<br />    @GeneratedValue(strategy = GenerationType.AUTO)<br />    @Column(name = "notice_id")<br />    @SerializedName(value = "notice_id")<br />    @Expose<br />    private Integer noticeId;<br /><br />    @Column(name="title", nullable = false)<br />    @Expose<br />    private String title;<br /><br />    @Column(name="content", nullable = false)<br />    @Expose<br />    private String content;<br /><br />    @Column(name="reg_date", nullable = false)<br />    @SerializedName(value = "reg_date")<br />    @Expose<br />    private String regDate;<br /><br />    @Column(name="del_yn", nullable = false)<br />    @Expose(serialize = false, deserialize = false)<br />    private String delYn;<br /><br />    public Integer getNoticeId() {<br />        return noticeId;<br />    }<br /><br />    public void setNoticeId(Integer noticeId) {<br />        this.noticeId = noticeId;<br />    }<br /><br />    public String getTitle() {<br />        return title;<br />    }<br /><br />    public void setTitle(String title) {<br />        this.title = title;<br />    }<br /><br />    public String getContent() {<br />        return content;<br />    }<br /><br />    public void setContent(String content) {<br />        this.content = content;<br />    }<br /><br />    public String getRegDate() {<br />        return regDate;<br />    }<br /><br />    public void setRegDate(String regDate) {<br />        this.regDate = regDate;<br />    }<br /><br />    public String getDelYn() {<br />        return delYn;<br />    }<br /><br />    public void setDelYn(String delYn) {<br />        this.delYn = delYn;<br />    }<br />}<br /></code></pre><br /><br /><br />3. repository 를 만들어줍니다. (아무것도 없는게.. 인상적)<br /><pre><code class="noxml"><br />public interface NoticeRepository extends JpaRepository&lt;Notice, Integer> {<br /><br />}<br /></code></pre><br /><br /><br />4. context-jpa.xml 설정합니다. (txManager2인 이유는 기존에 mybatis에 영향을 주지 않기 위해서입니다. , mybatis를 한번에 다 걷어낼 자신이 없...)<br /><pre><code><br /><?xml version="1.0" encoding="UTF-8"?><br /><beans xmlns="http://www.springframework.org/schema/beans"<br />    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"<br />    xmlns:jpa="http://www.springframework.org/schema/data/jpa"<br />    xmlns:tx="http://www.springframework.org/schema/tx"<br />    xmlns:aop="http://www.springframework.org/schema/aop"<br />    xmlns:p="http://www.springframework.org/schema/util"<br />    xsi:schemaLocation="http://www.springframework.org/schema/beans<br />    http://www.springframework.org/schema/beans/spring-beans.xsd<br />    http://www.springframework.org/schema/data/jpa<br />    http://www.springframework.org/schema/data/jpa/spring-jpa.xsd<br />    http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd<br />    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.1.xsd<br />    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd<br />    "><br /><br />    <!-- Configure the transaction manager bean --><br />    <bean class="org.springframework.orm.jpa.JpaTransactionManager" id="txManager2"><br />        <property name="entityManagerFactory" ref="entityManagerFactory"><br />        </property><br />    </bean><br /><br />    <tx:advice id="txAdvice2" transaction-manager="txManager2"><br />        <tx:attributes><br />            <tx:method name="*" rollback-for="Exception"><br />            </tx:method><br />        </tx:attributes><br />    </tx:advice><br /><br />    <aop:config><br />        <aop:pointcut expression="execution(* sample..service..*.sr*(..))" id="requiredTx2"><br />            <aop:advisor advice-ref="txAdvice2" pointcut-ref="requiredTx2"><br />            </aop:advisor><br />        </aop:pointcut><br />    </aop:config><br /><br />    <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter" id="hibernateJpaVendorAdapter"><br />        <property name="showSql" value="true"><br />        </property><br />    </bean><br /><br />    <!-- Configure the entity manager factory bean --><br />    <bean class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean" id="entityManagerFactory"><br />        <property name="dataSource" ref="dataSource"><br />            <property name="jpaVendorAdapter" ref="hibernateJpaVendorAdapter"><br />                <property name="packagesToScan" value="sample.app"><br />                </property><br />            </property><br />        </property><br />    </bean><br /><br />    <jpa:repositories base-package="sample.app" transaction-manager-ref="txManager2"><br />    </jpa:repositories><br /></beans><br /><br /></code></pre><br /><br /><br />5. 사용 예제<br /><pre><code class="noxml"><br />@Service<br />public class NoticeService extends ServiceBase  {<br />    private static final Logger logger = LoggerFactory.getLogger(NoticeService.class);<br /><br />    @Autowired<br />    private NoticeRepository noticeRepository;<br /><br />    public void srXX(RequestData req, ResponseData res) throws Exception {<br />        List&lt;Notice> list = noticeRepository.findAll();<br />        res.put("notice_list", list);<br />    }<br />}<br /></code></pre><br /><br />인터넷상에 자료가 많아서 설정은 어렵지 않았습니다.<br />하지만 실제로 사용에 요령이 필요하다고 하네요.. (제대로 이해를 하지 않고 사용하면 성능에도 영향을 준다고 함)