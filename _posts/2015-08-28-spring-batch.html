---
layout: post
title: 'spring batch 사용 '
date: '2015-08-27T22:44:00.001-07:00'
author: 페이퍼
tags:
- spring
modified_time: '2015-10-12T02:44:55.964-07:00'
blogger_id: tag:blogger.com,1999:blog-335715462918866001.post-5156884198111675879
blogger_orig_url: http://kimpaper.blogspot.com/2015/08/spring-batch.html
---

최근에 spring-batch를 사용해 봤는데.. 결과는 성공적 특히 트랜잭션commit size와 read size를 따로 지정할 수 있다는게 좋은것 같다.<br /><br />쿼리나 기타 로직보다 아래 설정이 중요한 듯 하여 아래 설정을 기록으로 남긴다.<br /><br />job에 대해서 요약하면<br /># reader에서 데이타를 읽어서 process 에서 처리 하고 writer로 결과를 기록 한다.<br /><br />물론 위 설정 외에 각 시작 구간마다 이벤트를 받아 처리 할 수 있는 listener 같은 것도 제공한다.<br /><br />reader, writer는 커스텀 하지 않고 mybatis에서 기본으로 제공하는 걸 이용했다.<br />참고) https://mybatis.github.io/spring/ko/batch.html<br /><br /><br /><pre><code><br /><bean id="jobLauncher" class="org.springframework.batch.core.launch.support.SimpleJobLauncher"><br />    <property name="jobRepository" ref="jobRepository" /><br /></bean><br /><br /><bean id="jobRepository"<br />  class="org.springframework.batch.core.repository.support.MapJobRepositoryFactoryBean"><br />  <property name="transactionManager" ref="transactionManager"/><br /></bean><br /><br /><!-- sent type sent --><br /><job:job id="rstJob" job-repository="jobRepository"><br />    <job:step id="step1"><br />        <tasklet><br />            <chunk reader="rstReader" processor="memberRstProcess"<br />             writer="rstWriter" commit-interval="500"><br />         </chunk><br />     </tasklet><br /> </job:step><br /></job:job><br /><br /><bean id="memberRstProcess" class="com.xxxxx.MemberRstProcess" /><br /><bean id="rstReader"<br />  class="org.mybatis.spring.batch.MyBatisPagingItemReader"<br />  p:sqlSessionFactory-ref="sqlSessionFactory"<br />  p:queryId="com.xxxxx.mapper.QueryMapper.selectMemberRstList"<br />  p:pageSize="500"<br />  scope="step" /><br /><br />  <bean id="rstWriter" class="org.mybatis.spring.batch.MyBatisBatchItemWriter"><br />    <property name="sqlSessionFactory" ref="sqlSessionFactory" /><br />    <property name="statementId" value="com.xxxxx.mapper.QueryMapper.updateMemberRst" /><br /></bean><br /></code></pre><br /><br /><br />